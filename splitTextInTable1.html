<textarea></textarea>
<input type="text">
<button>Table Generator</button>
<container></container>

<script>
 var txtRows;
 var txtrow;
 var newTable;
 document.querySelector("button").onclick = function() {
  txtRows = document.querySelector("textarea").value.split(/\n\r?/g);
  newTable = "<table>";
  for(let i=0; i<txtRows.length; i++) {
   newTable += "<tr>";
   txtRow = txtRows[i].split(document.querySelector("input").value);
   for(let j=0; j<txtRow.length; j++) {
    newTable += "<td>" + txtRow[j] + "</td>";
   }
   newTable += "</tr>";
  }
  newTable += "</table>";
  document.querySelector("container").innerHTML = newTable;
    const doc = document;
    const text = doc.querySelector("table");
    let range;
    let selection;

    if( doc.body.createTextRange ) {
        range = doc.body.createTextRange();
        range.moveToElement( text );
        range.select();
    } else if ( window.getSelection ) {
        selection = window.getSelection();

        range = doc.createRange();
        range.selectNodeContents( text );

        selection.removeAllRanges();
        selection.addRange( range );
    }
    document.execCommand( 'copy' );
    window.getSelection().removeAllRanges();

 }
</script>
